
<!doctype html>
<html lang="zh" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>é‚€è¯·è¿”åˆ© Â· ä¸‰çº§åˆ†é”€</title>
  <meta name="color-scheme" content="dark">
  <style>
    :root{
      --panel: rgba(17,24,39,.65);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --border: rgba(148,163,184,.2);
      --brand:#2563eb;
    }
    body{margin:0; font:16px/1.6 Arial,Helvetica,sans-serif; color:var(--text); background:linear-gradient(135deg,#0f172a,#020617 60%,#000)}
    .container{max-width:980px; margin:0 auto; padding:20px}
    h1{margin:8px 0 12px}
    .card{background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:16px; margin:12px 0}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    label{min-width:120px; color:var(--muted)}
    input,select{padding:10px 12px; border-radius:10px; border:1px solid var(--border); background:transparent; color:inherit; min-width:220px}
    input:focus,select:focus{outline:none; box-shadow:0 0 0 3px rgba(37,99,235,.25)}
    .btn{display:inline-flex; gap:6px; align-items:center; padding:10px 12px; border:1px solid var(--border); border-radius:10px; background:#0b1220; color:#e5e7eb; cursor:pointer; font-weight:700}
    .btn.primary{background:var(--brand); color:#fff; border-color:transparent}
    .grid{display:grid; gap:12px; grid-template-columns:1fr 1fr}
    @media (max-width:800px){ .grid{grid-template-columns:1fr} }
    .list{display:grid; gap:8px}
    .tag{display:inline-flex; gap:6px; align-items:center; background:rgba(255,255,255,.06); border:1px solid var(--border); border-radius:999px; padding:6px 10px; font-size:12px}
    .muted{color:var(--muted); font-size:12px}
    .sep{height:1px; background:var(--border); margin:10px 0}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,monospace}
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¤ é‚€è¯·è¿”åˆ© Â· ä¸‰çº§åˆ†é”€</h1>
    <p class="muted">è¿™æ˜¯å‰ç«¯æ¼”ç¤ºï¼šç”Ÿæˆé‚€è¯·ç ã€è®°å½•æœ€å¤š 3 çº§ä¸Šçº§ã€è®¡ç®—è¿”åˆ©ã€‚ç”Ÿäº§ç¯å¢ƒè¯·æ¥å…¥åç«¯é£æ§ä¸ç»“ç®—ã€‚</p>

    <!-- æˆ‘çš„é‚€è¯·ç  -->
    <div class="card">
      <h3>æˆ‘çš„é‚€è¯·ç </h3>
      <div class="row">
        <label>é‚€è¯·ç  / é‚€è¯·åœ°å€</label>
        <input id="myCode" class="mono" readonly />
        <button class="btn" id="genCode">é‡æ–°ç”Ÿæˆ</button>
      </div>
      <div class="row" style="margin-top:10px">
        <label>é‚€è¯·é“¾æ¥</label>
        <input id="inviteLink" class="mono" readonly />
        <button class="btn primary" id="copyLink">å¤åˆ¶é“¾æ¥</button>
      </div>
      <div class="muted" style="margin-top:6px">é»˜è®¤ä»¥**å·²è¿æ¥é’±åŒ…åœ°å€**ä½œä¸ºé‚€è¯·ç ï¼›å¦‚æœªè¿æ¥ï¼Œåˆ™ä½¿ç”¨æœ¬åœ°éšæœºç ã€‚é“¾æ¥å½¢å¦‚ï¼š<code class="mono">/crypto/index.html?ref=ä½ çš„ç </code></div>
      <div class="sep"></div>
      <div class="row">
        <a class="btn" href="/crypto/index.html">å»å¸‚åœºé¡µ</a>
        <button class="btn" id="simulateChild">æ·»åŠ æµ‹è¯•ä¸‹çº§ï¼ˆæœ¬åœ°ï¼‰</button>
      </div>
    </div>

    <!-- ä¸Šçº§é“¾ -->
    <div class="card">
      <h3>æˆ‘çš„ä¸Šçº§é“¾ï¼ˆæœ€å¤š 3 çº§ï¼‰</h3>
      <div id="upline" class="list"></div>
      <div class="row" style="margin-top:8px">
        <button class="btn" id="clearChain">æ¸…é™¤æœ¬åœ°ä¸Šçº§é“¾</button>
      </div>
    </div>

    <!-- è¿”åˆ©è§„åˆ™ä¸ç»“ç®—å™¨ -->
    <div class="card">
      <h3>è¿”åˆ©è§„åˆ™ & æ¨¡æ‹Ÿç»“ç®—</h3>
      <div class="grid">
        <div>
          <div class="row"><label>å¹³å°è´¹ç‡</label><input id="feeRate" type="number" step="0.01" value="0.20" /> <span>%</span></div>
          <div class="row"><label>L1 è¿”åˆ©</label><input id="r1" type="number" step="0.1" value="30" /> <span>%</span></div>
          <div class="row"><label>L2 è¿”åˆ©</label><input id="r2" type="number" step="0.1" value="10" /> <span>%</span></div>
          <div class="row"><label>L3 è¿”åˆ©</label><input id="r3" type="number" step="0.1" value="5" /> <span>%</span></div>
        </div>
        <div>
          <div class="row"><label>è®¢å•é‡‘é¢</label><input id="orderAmt" type="number" step="0.01" value="1000" /> <span>USD</span></div>
          <div class="row"><button class="btn primary" id="calc">è®¡ç®—</button></div>
          <div id="result" class="list"></div>
        </div>
      </div>
      <div class="muted" style="margin-top:6px">ç¤ºä¾‹ï¼šè‹¥è®¢å• 1000 USDã€å¹³å°è´¹ç‡ 0.2%ï¼Œåˆ™å¹³å°è´¹ 2 USDï¼›æŒ‰ 30/10/5% è¿”åˆ©ï¼ŒL1/L2/L3 åˆ†åˆ«ä¸º 0.60/0.20/0.10 USDã€‚</div>
    </div>

    <!-- æˆ‘çš„ä¸‹çº§ï¼ˆæœ¬åœ°æ¨¡æ‹Ÿï¼‰ -->
    <div class="card">
      <h3>æˆ‘çš„ä¸‹çº§ï¼ˆæœ¬åœ°æ¼”ç¤ºï¼‰</h3>
      <div id="downline" class="list"></div>
      <div class="muted">ä»…åœ¨æœ¬åœ°ä¿å­˜ç”¨äºæ¼”ç¤ºã€‚çœŸå®ç¯å¢ƒéœ€åç«¯å­˜å‚¨ã€åä½œå¼Šã€ç»“ç®—ä¸å¯¼å‡ºã€‚</div>
    </div>
  </div>

  <script>
  ;(()=> {
    const $ = s => document.querySelector(s);
    // è¯»å–é’±åŒ…åœ°å€ä½œä¸ºé»˜è®¤é‚€è¯·ç 
    const wallet = localStorage.getItem('wallet_addr') || '';
    function randomCode(){ return Array.from(crypto.getRandomValues(new Uint8Array(6))).map(b=>b.toString(36).slice(-1)).join('').toUpperCase(); }
    function getMyCode(){
      let code = localStorage.getItem('ref_my_code');
      if(!code){ code = wallet || ('U'+randomCode()); localStorage.setItem('ref_my_code', code); }
      return code;
    }
    function buildLink(){
      const origin = location.origin || '';
      const path = '/crypto/index.html';
      return `${origin}${path}?ref=${encodeURIComponent(getMyCode())}`;
    }
    // æ•æ‰ ?ref= å½¢æˆä¸Šçº§é“¾
    (function captureRef(){
      const ref = new URL(location.href).searchParams.get('ref');
      if(!ref) return;
      const old = JSON.parse(localStorage.getItem('ref_chain') || '[]');
      const set = new Set([ref, ...old]);
      const arr = Array.from(set).filter(x=>x && x!==getMyCode()).slice(0,3);
      localStorage.setItem('ref_chain', JSON.stringify(arr));
    })();

    function renderUpline(){
      const list = $('#upline'); list.innerHTML='';
      const chain = JSON.parse(localStorage.getItem('ref_chain') || '[]');
      if(!chain.length){ list.innerHTML = '<div class="muted">æš‚æ— ä¸Šçº§è®°å½•ï¼ˆé€šè¿‡ä»–äººé‚€è¯·é“¾æ¥è®¿é—®å°†è‡ªåŠ¨è®°å½•ï¼‰ã€‚</div>'; return; }
      const names = ['L1 ä¸Šçº§','L2 ä¸Šä¸Šçº§','L3 ç¬¬ä¸‰å±‚'];
      chain.forEach((c,i)=>{
        const div = document.createElement('div');
        div.innerHTML = `<span class="tag">${names[i]}</span> <span class="mono">${c}</span>`;
        list.appendChild(div);
      });
    }
    function renderDownline(){
      const down = JSON.parse(localStorage.getItem('ref_downline') || '[]');
      const cont = $('#downline'); cont.innerHTML='';
      if(!down.length){ cont.innerHTML='<div class="muted">æš‚æ— ä¸‹çº§ï¼ˆç‚¹å‡»ã€Œæ·»åŠ æµ‹è¯•ä¸‹çº§ã€æœ¬åœ°é€ æ•°ï¼‰ã€‚</div>'; return; }
      down.forEach(d=>{
        const div = document.createElement('div');
        div.innerHTML = `<span class="tag">L1</span> <span class="mono">${d.code}</span> <span class="muted">${new Date(d.ts).toLocaleString()}</span>`;
        cont.appendChild(div);
      });
    }

    // äº‹ä»¶
    $('#myCode').value = getMyCode();
    $('#inviteLink').value = buildLink();
    $('#genCode').onclick = ()=>{ localStorage.removeItem('ref_my_code'); $('#myCode').value=getMyCode(); $('#inviteLink').value=buildLink(); };
    $('#copyLink').onclick = async()=>{ try{ await navigator.clipboard.writeText($('#inviteLink').value); alert('å·²å¤åˆ¶'); }catch{ alert('å¤åˆ¶å¤±è´¥'); } };
    $('#simulateChild').onclick = ()=>{
      const arr = JSON.parse(localStorage.getItem('ref_downline') || '[]');
      arr.push({ code: 'U'+Math.random().toString(36).slice(2,8).toUpperCase(), ts: Date.now() });
      localStorage.setItem('ref_downline', JSON.stringify(arr));
      renderDownline();
    };
    $('#clearChain').onclick = ()=>{ localStorage.removeItem('ref_chain'); renderUpline(); };

    // ç»“ç®—è®¡ç®—å™¨
    $('#calc').onclick = ()=>{
      const amt = Number($('#orderAmt').value||0);
      const feeRate = Number($('#feeRate').value||0)/100;
      const r1 = Number($('#r1').value||0)/100, r2 = Number($('#r2').value||0)/100, r3 = Number($('#r3').value||0)/100;
      const fee = amt * feeRate;
      const v1 = fee * r1, v2 = fee * r2, v3 = fee * r3;
      $('#result').innerHTML = `
        <div><span class="tag">å¹³å°è´¹</span> ${fee.toFixed(6)} USD</div>
        <div><span class="tag">L1</span> ${v1.toFixed(6)} USD</div>
        <div><span class="tag">L2</span> ${v2.toFixed(6)} USD</div>
        <div><span class="tag">L3</span> ${v3.toFixed(6)} USD</div>
      `;
    };

    renderUpline(); renderDownline();
  })();
  </script>
</body>
</html>
